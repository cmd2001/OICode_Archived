20180528小测

终于不是暴力大战了QAQ

T1:

一道十分奇妙的人类智慧题......
二次函数(求导)易证题面中给的那个操作就是求算术平均值......
然后我发现每次操作相当于把坐标对答案的贡献乘以1/k，然后就失去梦想写暴力了......
考虑这个暴力怎么写，任凭实数炸精度显然是不行的，我们可以在mod 998244353下计算坐标，把最终答案都丢进一个set里面，最后输出它的size。
我们在dfs的时候可以用vector传递一个状态，在dfs中next_permutation枚举下一个状态(钦定前k个进行合并)。
由于这么枚举状态会dfs到重复状态，所以我们要对表示状态vector再次哈希判重。
(话说这又是vector又是set又是哈希套哈希的居然还能有15分)
考虑正解，显然我们可以把合并操作建立成一棵满k叉树。
对于同一层的所有点，我们可以排序；对于一个非叶子节点，如果它的孩子的颜色全部相同，那么我们可以删去它的孩子把自己变成一个和孩子颜色相同的点。
通过这样的操作，我们一定能把一棵满k叉树变成每一层只有k-1个叶子和一个中间节点(最深层k个叶子)的形态，并且由于深度+1使得贡献乘以1/k，这种树一定一一对应一个最终位置(虽然不一定合法)。
如果我们设树的深度为x，黑点总数为y，那么这样的树的个数就是一个经典的数位DP问题(长度为x的k进制数，数字和为y)。
但是这样存在后缀零，计算答案时去掉后缀零的话，我们让dp[x][y]减去dp[x-1][y]就好了。
考虑这样的树什么情况下合法，我们需要把它还原回去，计算黑色节点总数和白色节点总数。
显然一次缩点操作减少k-1个节点，所以如果n-黑色点总数或者m-白色点总数取模k-1不为0的话，肯定不行。
然后就能AC啦。
15分暴力代码:
正解代码:

T2:

这看起来是猫(给)锟的题啊......
不过应该把加强两个字去掉，这就是北京八十中集训的原题。
显然我们每条边都要走一遍......
考虑一个初始情况，我们不加任何边，那么，树上的每条边我们都要走两遍，相当于在正常走一遍的情况下再把树遍历一遍。
所以我们可以减去边权总和，这样我们要计算的就是通过连接不超过k条边权为v的边，把树遍历一遍的的最小代价。
如果我们先不考虑不超过k条这个限制，仅考虑代价最小的话，显然连接的边数是关于v单调递减的。
所以我们可以二分这个v，找到一个需要的边数恰好<=k的v，然后用现在的边数和原来的v计算答案。
现在我们知道了v，怎么计算最小代价和需要的边数呢(显然我们在代价相同的时候要让增加的边尽可能的小)？
这是一个很经典的DP问题，f[i][0/1]表示遍历i的子树，i这个点有无新加边的接头的最小代价及边数，转移手玩一下就好了。
初始化f[i][0]=(0,0),f[i][1]=(v,1)，转移就是
f[i][0]=min{f[i][0]+f[son][0]+(len,0),f[i][1]+f[son][1]-(v,1),f[i][1]+f[son][0]+(len,0),f[i][0]+f[son][1]},
f[i][1]=min{f[i][0]+f[son][0]+(len,0)+(v,1),f[i][1]+f[son][1],f[i][1]+f[son][0]+(len,0),f[i][0]+f[son][1]};
的说。
统计答案的时候注意在使用我们二分的v计算时，需要的边数可能比k小，但是我们一定要强制替换k条边，
因为我们二分的v一定比给定的v大，这样相当于把一些和大v等价的东西替换成了小v，一定更优。否则会WA。
代码:

T3:

显然我们能枚举每一条边并计算贡献，就是边权乘以包含这条边的方案数，也就是(C(n,k)-C(siz1,k)-C(siz2,k))*len了。
(别忘了最后乘逆元)
然后我失去梦想就写了60分n^2暴力......
但是，我们观察这个答案的形式非常优美是吧，根本不需要n^2的！
先把C(n,k)*len扔掉，这就是一个组合数乘以边权之和。
于是答案成了-C(t,k)*len的形式，就是-len*t!/k!(t-k)!，我们可以把-1/k!先提出来。
然后我们要卷积的就是，len*t!/(t-k)!，我们把后面的东西翻转一下(把(t-k)!放到位置n-(t-k))，于是关于k的答案就会被卷积到位置n+k了，之后随便做就好啦。
明明是这么显然的卷积，考场上为什么推不出来啊！！！
(果然还是太菜了呢)
60分暴力代码:
正解代码:

虽然因为中文文件夹名爆了一发零(这个真不赖我)，但是这次170(如果不爆栈是175)的成绩也是rank1了。
THU夏令营初审也通过了，大概又要去被虐了呢(没学上.jpg)。
(我果然还是太菜了呢)

あのとき描(えが)いた 約束(やくそく)の場所(ばしょ)で
用心去描绘那一天 在这约定中的地点
きっと いつまでも 待(ま)ってるよ
无论 何时都会在 这里等待
笑顔(えがお)で 抱(だ)きしめるから
带着笑颜，相拥着回首从前
いくつもの 涙(なみだ)の意味(いみ)
究竟眼泪它代表多少意义
忘(わす)れてた気持(きも)ち 教(おし)えてくれたね
请再一次让我感受 早已忘却了的感情
移(うつ)りゆく景色(けしき)の中(なか)で
漫步着去铭记童话般的美景
同(おな)じ道(みち)を歩(ある)いてきた
在同一条路上我们相伴前行
差(さ)し出(だ)した手(て)に 思(おも)い出(で)と
向彼此伸出双手 我终于确定
ボクらの選(えら)んだ（大切(たいせつ)な）
选择了从今天起（最重要的是）
これからが
去奔向黎明

(防止咕咕咕所以先粘贴歌词)
