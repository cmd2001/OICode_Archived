迷之查做题？

于是我就被教练迷之查了一发做题进度。
虽然无力吐槽，然而我还是把这几道题都写(水)了。
查到我的题目是：BZOJ3529,BZOJ2243,BZOJ3065。
然而我一开始只写了BZOJ3529......

BZOJ3529：
先反演然后树状数组，对于每个值的f用nlog筛即可。
代码：

BZOJ2243：
树链剖分线段树维护节点颜色，具体就是维护两边颜色和中间颜色个数。
写一个Node类就好做多了。
记得链合并时一边需要reverse(因为我的线段树从左向右都是从上到下)。
对于lca为a或b的需要特判，或者通过两次判定deep省去特判。详见代码。
(分类讨论什么的，自己纸上画一画就明白了)
另外一开始query的时候没写push给WA了一回。
代码：

BZOJ3065:
带插入修改区间k小值？
平衡树套主席树？
对不起，我只会分块，分块大法好。直接进前20。
代码：




